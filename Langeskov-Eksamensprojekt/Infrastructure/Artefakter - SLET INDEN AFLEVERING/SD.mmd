sequenceDiagram
    participant User
    participant V as RunnerControl (View)
    participant C as RunnerControl.xaml.cs (Code-Behind)
    participant VM as RunnerViewModel
    participant R as ISQLRunnerRepository
    participant DB as Database

    %% Initial Load %%
    C->>C: new SQLRunnerRepository()
    C->>VM: new RunnerViewModel(repository)
    C->>V: DataContext = viewModel
    VM->>VM: LoadRunners()
    VM->>R: GetAll()
    R->>DB: Executes SELECT query
    DB-->>R: Returns runner data
    R-->>VM: Maps and returns List<Runner>
    VM->>V: Updates ObservableCollection<Runner>
    V-->>User: Displays list of runners

    %% Add Runner Use Case %%
    User->>V: Enters runner details
    User->>V: Clicks 'CreateRunnerCommand' Button
    V->>VM: CreateRunnerCommand.Execute()
    VM->>VM: Validates new runner properties
    alt Validation Success
        VM->>R: Add(newRunner)
        R->>DB: Executes INSERT query
        DB-->>R: Confirms addition
        R-->>VM: Returns success
        VM->>V: Adds new runner to ObservableCollection
        V-->>User: Grid is updated with new runner
    else Validation Failure
        VM-->>User: Displays error message (implicitly via UI binding)
    end

    %% Update Runner Use Case %%
    User->>V: Edits a runner in the DataGrid
    V->>C: Triggers RowEditEnding event
    C->>VM: UpdateRunnerCommand.Execute(editedRunner)
    VM->>VM: Validates edited runner
    VM->>R: Update(editedRunner)
    R->>DB: Executes UPDATE query
    DB-->>R: Confirms update
    R-->>VM: Returns success
    %% The ObservableCollection automatically reflects changes %%
    V-->>User: Grid is updated with new values

    %% Delete Runner Use Case %%
    User->>V: Selects a runner
    User->>V: Clicks 'DeleteRunnerCommand' Button
    V->>VM: DeleteRunnerCommand.Execute(selectedRunner)
    VM->>R: Delete(selectedRunner.Id)
    R->>DB: Executes DELETE query
    DB-->>R: Confirms deletion
    R-->>VM: Returns success
    VM->>V: Removes runner from ObservableCollection
    V-->>User: Runner disappears from grid
